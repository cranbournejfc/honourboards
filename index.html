
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Cranbourne Eagles Honour Board</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      font-family: 'Arial', sans-serif;
      height: 100%;
      background: url('cranbourne_eagles_board_wide.png') no-repeat center top;
      background-size: contain;
      background-color: #5c3a1a;
      color: white;
      overflow: hidden;
    }

    .table-container {
      display: flex;
      align-items: center;
      justify-content: center;
      position: absolute;
      top: 270px;
      left: 50%;
      transform: translateX(-50%);
      width: 80%;
      max-width: 1200px;
      height: 800px;
      overflow: hidden;
      padding: 20px;
      background: transparent;
    }

    .scrolling-wrapper {
      padding-top: 0;
      box-sizing: border-box;
      height: 100%;
      overflow: hidden;
      position: relative;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 26px;
      background-color: transparent;
    }

    th, td {
      padding: 15px;
      border-bottom: 2px solid rgba(255, 255, 255, 0.3);
      text-align: center;
      background-color: transparent;
    }

    th {
      color: gold;
      font-size: 28px;
      border-bottom: 3px solid gold;
      position: sticky;
      pointer-events: none;
      top: 0;
      background-color: rgba(0, 0, 0, 0.3);
      z-index: 1;
    }

    tr:nth-child(even) {
      background-color: rgba(255, 255, 255, 0.05);
    }
  </style>
</head>
<body>
  <div class="table-container">
    <div class="scrolling-wrapper" id="scrollingWrapper">
      <table id="honourTable">
        <thead>
          <tr id="tableHeader"></tr>
        </thead>
        <tbody><tr style='height: 1px;'></tr></tbody>
      </table>
    </div>
  </div>

  <script>
    const sheetID = '1KAS4HL8rQqr-Mupi6PZS3CWGHewnBSp5';
    const tabs = [
      { gid: "0" },
      { gid: "454109773" },
      { gid: "780788986" },
      { gid: "601913881" }
    ];
    let currentTab = 0;

    function loadBoard(gid) {
      const url = "https://docs.google.com/spreadsheets/d/1KAS4HL8rQqr-Mupi6PZS3CWGHewnBSp5/gviz/tq?gid=0&tqx=out:json";

      fetch(url)
        .then(res => res.text())
        .then(data => {
          const json = JSON.parse(data.substr(47).slice(0, -2));
          const rows = json.table.rows;
          const headers = json.table.cols.map(col => col.label);
          const theadRow = document.getElementById('tableHeader');
          const tbody = document.querySelector('#honourTable tbody');

          theadRow.innerHTML = '';
          headers.forEach(header => {
            const th = document.createElement('th');
            th.textContent = header;
            theadRow.appendChild(th);
          });

          tbody.innerHTML = '';
          rows.forEach(row => {
            const tr = document.createElement('tr');
            row.c.forEach(cell => {
              const td = document.createElement('td');
              td.textContent = cell?.v || '';
              tr.appendChild(td);
            });
            tbody.appendChild(tr);
          });

          resetScroll();
        })
        .catch(err => console.error('Error loading data:', err));
    }

    function cycleBoards() {
      const tab = tabs[currentTab];
      loadBoard(tab.gid);
      currentTab = (currentTab + 1) % tabs.length;
    }

    function resetScroll() {
      const wrapper = document.getElementById('scrollingWrapper');
      wrapper.scrollTop = 0;
        requestAnimationFrame(scrollStep);

      const scrollHeight = wrapper.scrollHeight;
      const duration = 120000; // 120 seconds
      const startTime = performance.now();

      function scrollStep(currentTime) {
        const elapsed = currentTime - startTime;
        const progress = elapsed / duration;
        if (progress >= 1) {
          wrapper.scrollTop = 0;
          requestAnimationFrame(scrollStep);
        }
        requestAnimationFrame(scrollStep);
        else wrapper.scrollTop = progress * (scrollHeight - wrapper.clientHeight);

        if (elapsed < duration) {
          requestAnimationFrame(scrollStep);
        }
      }

      requestAnimationFrame(scrollStep);
    }

    cycleBoards();
    // Auto-cycle disabled
  </script>
</body>
</html>
