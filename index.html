
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Cranbourne Eagles Honour Board</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      font-family: 'Arial', sans-serif;
      height: 100%;
      background: url('cranbourne_eagles_board.png') no-repeat center top;
      background-size: contain;
      background-color: #5c3a1a;
      color: white;
      overflow: hidden;
    }

    .table-container {
      position: absolute;
      top: 230px;
      left: 50%;
      transform: translateX(-50%);
      width: 80%;
      max-width: 1200px;
      padding: 20px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 26px;
      background: transparent;
    }

    th, td {
      padding: 15px;
      border-bottom: 2px solid rgba(255, 255, 255, 0.3);
      text-align: center;
    }

    th {
      color: gold;
      font-size: 28px;
      border-bottom: 3px solid gold;
    }

    tr:nth-child(even) {
      background-color: rgba(255, 255, 255, 0.05);
    }
  </style>
</head>
<body>
  <div class="table-container">
    <table id="honourTable">
      <thead>
        <tr>
          <th>Year</th>
          <th>Name</th>
          <th>Award</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <script>
    const sheetID = 'YOUR_SHEET_ID_HERE';
    const url = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?tqx=out:json`;

    function fetchHonourBoard() {
      fetch(url)
        .then(res => res.text())
        .then(data => {
          const json = JSON.parse(data.substr(47).slice(0, -2));
          const rows = json.table.rows;
          const tbody = document.querySelector('#honourTable tbody');
          tbody.innerHTML = ''; // Clear previous rows

          rows.forEach(row => {
            const tr = document.createElement('tr');
            row.c.forEach(cell => {
              const td = document.createElement('td');
              td.textContent = cell?.v || '';
              tr.appendChild(td);
            });
            tbody.appendChild(tr);
          });
        })
        .catch(err => console.error('Error loading data:', err));
    }

    fetchHonourBoard();
    setInterval(fetchHonourBoard, 30000); // Refresh every 30 seconds
  </script>
</body>
</html>
